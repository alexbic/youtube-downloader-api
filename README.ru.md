# YouTube Downloader API

**Open Source** REST API –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ —Å YouTube –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã.

[![Docker Hub](https://img.shields.io/docker/v/alexbic/youtube-downloader-api?label=Docker%20Hub&logo=docker)](https://hub.docker.com/r/alexbic/youtube-downloader-api)
[![GitHub Container Registry](https://img.shields.io/badge/ghcr.io-image-blue?logo=github)](https://github.com/alexbic/youtube-downloader-api/pkgs/container/youtube-downloader-api)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Version](https://img.shields.io/badge/version-1.0.0-blue)](docs/RELEASE_NOTES_v1.0.0.md)
[![Changelog](https://img.shields.io/badge/changelog-1.0.0-blue)](docs/CHANGELOG.md)

> ‚ö†Ô∏è **–ü–£–ë–õ–ò–ß–ù–ê–Ø –í–ï–†–°–ò–Ø**: –≠—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏ (2 –≤–æ—Ä–∫–µ—Ä–∞, TTL 24—á, 256MB Redis).
> üöÄ **–ù—É–∂–Ω–æ –±–æ–ª—å—à–µ?** –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [YouTube Downloader API Pro](https://github.com/alexbic/youtube-downloader-api-pro) - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ PostgreSQL, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π TTL, –∫–µ—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!

[English](README.md) | **–†—É—Å—Å–∫–∏–π**

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üé¨ **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä—è–º—ã—Ö URL** - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–∏–¥–µ–æ –±–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- ‚¨áÔ∏è **–°–µ—Ä–≤–µ—Ä–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ** - –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –≤—ã–±–æ—Ä–æ–º –∫–∞—á–µ—Å—Ç–≤–∞ (sync/async)
- üìä **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–¥–µ–æ** - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- üîÑ **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º—ã** - –≤—ã–±–æ—Ä –º–µ–∂–¥—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –∏–ª–∏ —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- üîó **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ webhook** - POST —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏
- üîÅ **Webhook resender** - —Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –Ω–µ—É–¥–∞–≤—à–∏–µ—Å—è webhook –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- üîë **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Bearer —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π
- üåê **–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ URL** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö URL
- üì¶ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Redis** - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–¥–∞—á –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis)
- üîí **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ cookies** - –æ–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π YouTube
- üßπ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
- üê≥ **–ì–æ—Ç–æ–≤ –¥–ª—è Docker** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä (amd64, arm64)
- üìù **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞** - –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö JSON —á–µ—Ä–µ–∑ –≤–µ—Å—å workflow

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ò–∑ Docker Hub (–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏:**
- ‚úÖ –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º Redis
- ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã: 2 –≤–æ—Ä–∫–µ—Ä–∞, TTL 24—á, 256MB Redis
- ‚úÖ –ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚ö†Ô∏è –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è (–¥–ª—è –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pro –≤–µ—Ä—Å–∏—é)

```bash
docker pull alexbic/youtube-downloader-api:latest
docker run -d -p 5000:5000 --name yt-downloader alexbic/youtube-downloader-api:latest
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:5000/health

# –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
curl -X POST http://localhost:5000/download_video \
  -H "Content-Type: application/json" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"}'

# –ü–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É
curl -X POST http://localhost:5000/get_direct_url \
  -H "Content-Type: application/json" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"}'
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ó–∞–ø—É—Å–∫ —Å cookies –¥–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã YouTube

YouTube –º–æ–∂–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏, —Ç—Ä–µ–±—É—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

**‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–æ cookies:**
- YouTube —Ä–æ—Ç–∏—Ä—É–µ—Ç cookies –≤ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –≤–∫–ª–∞–¥–∫–∞—Ö –∫–∞–∫ –º–µ—Ä—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Cookies, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑ –æ–±—ã—á–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏, –±—ã—Å—Ç—Ä–æ –ø—Ä–æ—Ç—É—Ö–∞—é—Ç
- –ù—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ **–ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –æ–∫–Ω–æ** –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –º–µ—Ç–æ–¥–∏–∫–µ

#### –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–®–∞–≥ 1. –í–∫–ª—é—á–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ:**

**Chrome:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `chrome://extensions/`
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ [Get cookies.txt LOCALLY](https://chromewebstore.google.com/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc)
3. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥—Ä–æ–±–Ω–µ–µ"** (Details)
4. –í–∫–ª—é—á–∏—Ç–µ **"–†–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ"** (Allow in incognito)

**Firefox:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `about:addons`
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ [cookies.txt](https://addons.mozilla.org/ru/firefox/addon/cookies-txt/)
3. –í–∫–ª—é—á–∏—Ç–µ **"–í—ã–ø–æ–ª–Ω—è—Ç—å –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –æ–∫–Ω–∞—Ö"** (Run in Private Windows)

**–®–∞–≥ 2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ cookies:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ **–Ω–æ–≤–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ/–∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –æ–∫–Ω–æ** –∏ –∑–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –Ω–∞ YouTube
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `https://www.youtube.com/robots.txt`
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ cookies –¥–ª—è `youtube.com` —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (—Ç–µ–ø–µ—Ä—å –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!)
4. **–°—Ä–∞–∑—É –∑–∞–∫—Ä–æ–π—Ç–µ** –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –æ–∫–Ω–æ

#### –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ DevTools (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π)

1. –û—Ç–∫—Ä–æ–π—Ç–µ **–Ω–æ–≤–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ/–∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –æ–∫–Ω–æ** –∏ –∑–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –Ω–∞ YouTube
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `https://www.youtube.com/robots.txt`
3. –û—Ç–∫—Ä–æ–π—Ç–µ **DevTools** (F12 –∏–ª–∏ Cmd+Option+I)
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Console**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```javascript
copy(document.cookie.split('; ').map(c => {
  const [name, ...v] = c.split('=');
  return `.youtube.com\tTRUE\t/\tTRUE\t0\t${name}\t${v.join('=')}`;
}).join('\n'))
```

6. Cookies —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ ‚Äî –≤—Å—Ç–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `cookies.txt`
7. **–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞:** `# Netscape HTTP Cookie File`
8. **–°—Ä–∞–∑—É –∑–∞–∫—Ä–æ–π—Ç–µ** –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –æ–∫–Ω–æ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--cookies-from-browser` ‚Äî –æ–Ω –±–µ—Ä—ë—Ç cookies –∏–∑ –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
- DevTools –¥–∞—ë—Ç –±–∞–∑–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç; –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cookies:

1. –ü–æ–ª–æ–∂–∏—Ç–µ `cookies.txt` —Ä—è–¥–æ–º —Å `docker-compose.yml`
2. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É:

```yaml
volumes:
  - ./cookies.txt:/app/cookies.txt
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `docker-compose up -d`

**–ì–æ—Ç–æ–≤–æ!** API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç cookies –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç timestamp –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º.

#### PO Token (–¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ):

YouTube –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–≤–æ–¥–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ "PO Token" –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è. –ï—Å–ª–∏ cookies –Ω–µ –ø–æ–º–æ–≥–∞—é—Ç:
- –ò–∑—É—á–∏—Ç–µ [PO Token Guide](https://github.com/yt-dlp/yt-dlp/wiki/PO-Token-Guide)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `mweb` –∫–ª–∏–µ–Ω—Ç —Å PO Token
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é yt-dlp –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
- [–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å YouTube cookies](https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies)
- [–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ YouTube](https://github.com/yt-dlp/yt-dlp/wiki/Extractors#common-youtube-errors)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É 5-10 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –õ–∏–º–∏—Ç –¥–ª—è –≥–æ—Å—Ç–µ–π: ~300 –≤–∏–¥–µ–æ/—á–∞—Å, –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤: ~2000 –≤–∏–¥–µ–æ/—á–∞—Å

### Docker Compose (–ö–∞—Å—Ç–æ–º–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)

> ‚ö†Ô∏è **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis. –≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π.

```yaml
version: '3.8'
services:
  youtube-downloader:
    image: alexbic/youtube-downloader-api:latest
    ports:
      - "5000:5000"
    volumes:
      - ./tasks:/app/tasks
      # - ./cookies.txt:/app/cookies.txt  # –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    environment:
      # –ü—É–±–ª–∏—á–Ω—ã–π –±–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ (https://yourdomain.com/api)
      PUBLIC_BASE_URL: ${PUBLIC_BASE_URL}
      # API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Bearer —Ç–æ–∫–µ–Ω)
      API_KEY: ${API_KEY}
    restart: unless-stopped
```

## API Endpoints

### 1. Health Check

```bash
GET /health
```

–û—Ç–≤–µ—Ç (–ø–æ–ª—è –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏):
```json
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:00.123456",
  "auth": "enabled|disabled",
  "storage": "redis|memory"
}
```

### 2. –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ (sync/async)

```bash
POST /download_video
Content-Type: application/json
```

–ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON (async):
```json
{
  "url": "https://www.youtube.com/watch?v=pj8lIC7kP6I",
  "async": true,
  "quality": "best[height<=720]",
  "client_meta": {"videoId": "pj8lIC7kP6I"}
}
```

–ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON (sync):
```json
{
  "url": "https://www.youtube.com/watch?v=pj8lIC7kP6I",
  "quality": "best[height<=720]",
  "client_meta": {"videoId": "pj8lIC7kP6I"}
}
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `url` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ YouTube
- `async` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, bool) ‚Äî –µ—Å–ª–∏ true, –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –∏–Ω–∞—á–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- `quality` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, string) ‚Äî —Ñ–æ—Ä–º–∞—Ç yt-dlp, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `best[height<=720]`
- `cookiesFromBrowser` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, string) ‚Äî –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è cookies (`chrome`, `firefox`, `safari`, `edge`; —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–µ –≤ Docker)
- `client_meta` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, object) ‚Äî –ª—é–±—ã–µ –≤–∞—à–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ; —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `metadata.json` –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ
- `webhook_url` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, string) ‚Äî URL (http/https) –¥–ª—è callback –≤ async-—Ä–µ–∂–∏–º–µ; –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST —Å JSON (—Å–º. —Ä–∞–∑–¥–µ–ª Webhook)

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ (—Å–º. PUBLIC_BASE_URL + API_KEY): –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫
`Authorization: Bearer <API_KEY>` (–∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π `X-API-Key`).


#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (sync):
```json
{
  "task_id": "ab12cd34-...",
  "status": "completed",
  "video_id": "pj8lIC7kP6I",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ",
  "filename": "video_20251114_212811.mp4",
  "file_size": 15728640,
  "download_endpoint": "/download/ab12cd34.../output/video_20251114_212811.mp4",
  "storage_rel_path": "ab12cd34.../output/video_20251114_212811.mp4",
  "task_download_url": "http://public.example.com/download/ab12cd34.../output/video_20251114_212811.mp4",
  "task_download_url_internal": "http://service.local:5000/download/ab12cd34.../output/video_20251114_212811.mp4",
  "metadata_url": "http://public.example.com/download/ab12cd34.../metadata.json",
  "metadata_url_internal": "http://service.local:5000/download/ab12cd34.../metadata.json",
  "duration": 180,
  "resolution": "1280x720",
  "ext": "mp4",
  "client_meta": {"videoId": "pj8lIC7kP6I"},
  "processed_at": "2025-11-14T21:28:11.123456"
}
```

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (async):
```json
{
  "task_id": "ab12cd34-...",
  "status": "processing",
  "check_status_url": "http://public.example.com/task_status/ab12cd34-...",
  "check_status_url_internal": "http://service.local/task_status/ab12cd34-...",
  "metadata_url": "http://public.example.com/download/ab12cd34.../metadata.json",
  "metadata_url_internal": "http://service.local/download/ab12cd34.../metadata.json",
  "client_meta": {"videoId": "pj8lIC7kP6I"}
}
```

> **–í–∞–∂–Ω–æ:** –í async-—Ä–µ–∂–∏–º–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤–∏–¥–µ–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ, —É–¥–∞–ª–µ–Ω–æ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∏ —Ç.–¥.) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `/task_status/<task_id>`. –°–∞–º –æ—Ç–≤–µ—Ç –Ω–∞ POST –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ task_id –∏ —Å—Ç–∞—Ç—É—Å. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–ª–∏ –æ—à–∏–±–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ `/task_status/<task_id>`.

–í sync-—Ä–µ–∂–∏–º–µ –æ—à–∏–±–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É —Å HTTP 400 –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏.

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏

```bash
GET /task_status/<task_id>
```

–û—Ç–≤–µ—Ç (–≤–∞—Ä–∏–∞–Ω—Ç—ã):
- status=processing: `{ "task_id": "...", "status": "processing" }`
- status=completed: –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª—è `download_endpoint`, `storage_rel_path`, `task_download_url(_internal)`, `metadata_url(_internal)`, –∞ —Ç–∞–∫–∂–µ –º–µ–¥–∏–∞-–ø–æ–ª—è (`filename`, `duration`, `resolution`, `ext`, `title`, `video_id`, `created_at`, `completed_at`).
- status=error: –≤–∫–ª—é—á–∞–µ—Ç `error_type`, `error_message`, `user_action`, –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ `raw_error`.

–ü–æ–ª–µ `client_meta` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫ –∫–ª—é—á–µ–π JSON).

### 4. –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

```bash
GET /download/<task_id>/output/<file>
GET /download/<task_id>/metadata.json
```

### 5. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ

```bash
POST /get_direct_url
Content-Type: application/json

{
  "url": "https://www.youtube.com/watch?v=VIDEO_ID",
  "quality": "best[height<=720]"
}
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `url` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - URL –≤–∏–¥–µ–æ YouTube
- `quality` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `best[height<=720]`)
  - `best[height<=720]` - –ª—É—á—à–µ–µ –¥–æ 720p
  - `best[height<=480]` - –ª—É—á—à–µ–µ –¥–æ 480p
  - `best[height<=1080]` - –ª—É—á—à–µ–µ –¥–æ 1080p
  - `best` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ

–û—Ç–≤–µ—Ç:
```json
{
  "video_id": "VIDEO_ID",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ",
  "direct_url": "https://...",
  "duration": 180,
  "filesize": 15728640,
  "ext": "mp4",
  "resolution": "1280x720",
  "fps": 30,
  "thumbnail": "https://...",
  "uploader": "Channel Name",
  "upload_date": "20240115",
  "http_headers": {"User-Agent": "..."},
  "expiry_warning": "URL expires in a few hours. Use immediately or call /download_video to save permanently.",
  "processed_at": "2024-01-15T10:30:00.123456"
}
```

**–í–∞–∂–Ω–æ:** –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏ –º–æ–≥—É—Ç –≤—ã–¥–∞—Ç—å 403 Forbidden –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏. –î–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/download_video` (async –∏–ª–∏ sync).

### 6. n8n: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ö–µ–º–∞ (—á–µ—Ä–µ–∑ /download_video)

**–®–∞–≥ 0: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ n8n –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏**

–î–æ–±–∞–≤—å—Ç–µ –≤ docker-compose.yml –≤–∞—à–µ–≥–æ n8n —Å—Ç–µ–∫–∞:
```yaml
services:
  n8n:
    environment:
      - N8N_DEFAULT_BINARY_DATA_MODE=filesystem
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ n8n –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

–í–∞—Ä–∏–∞–Ω—Ç A (sync, –ø—Ä–æ—â–µ):
1) POST http://youtube_downloader:5000/download_video (Body: `{ "url": "..." }`)
2) –í –æ—Ç–≤–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `task_download_url` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (Response Format: File, Binary Property: data)

–í–∞—Ä–∏–∞–Ω—Ç B (async, –Ω–∞–¥—ë–∂–Ω–µ–µ –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á):
1) POST /download_video c `{"url":"...","async":true}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å `task_id`
2) –¶–∏–∫–ª–∏—á–µ—Å–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å `/task_status/{{task_id}}` –¥–æ `status=completed`
3) –°–∫–∞—á–∞—Ç—å `{{ $json.task_download_url }}` (Response Format: File, Binary Property: data)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ**:
1. n8n –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å `N8N_DEFAULT_BINARY_DATA_MODE=filesystem`
2. –í Node 2 —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ "Response Format" –≤ –∑–Ω–∞—á–µ–Ω–∏–µ "File"
3. –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ n8n –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ –≤ –ø–∞–º—è—Ç—å –∏ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É "Cannot create a string longer than 0x1fffffe8 characters"

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ë—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ URL. –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –µ—Å—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª—è `*_internal`.

–ü—Ä–æ `client_meta` –≤ n8n: –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç/–º–∞—Å—Å–∏–≤ –∫–∞–∫ –µ—Å—Ç—å (–Ω–µ —Å—Ç—Ä–æ–∫—É). –ï—Å–ª–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç–µ —á–µ—Ä–µ–∑ Expression ‚Äî –Ω–µ –∑–∞–∫–ª—é—á–∞–π—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≤ –∫–∞–≤—ã—á–∫–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å `"[object Object]"`.

### 7. Webhook callbacks (async)

–ï—Å–ª–∏ –≤ `POST /download_video` –ø–µ—Ä–µ–¥–∞–Ω `webhook_url` (–∏–ª–∏ –∞–ª–∏–∞—Å—ã `webhook`, `callback_url`), —Å–µ—Ä–≤–∏—Å –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –¥–µ–ª–∞–µ—Ç `POST` –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π URL —Å `Content-Type: application/json`.

–£—Å–ø–µ—à–Ω—ã–π payload (–ø–æ–ª—è –∫–∞–∫ –≤ `task_status`, `client_meta` ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–º):
```json
{
  "task_id": "...",
  "status": "completed",
  "video_id": "...",
  "title": "...",
  "filename": "...mp4",
  "download_endpoint": "/download/.../output/...mp4",
  "storage_rel_path": ".../output/...mp4",
  "duration": 213,
  "resolution": "640x360",
  "ext": "mp4",
  "created_at": "2025-11-15T06:18:46.629918",
  "completed_at": "2025-11-15T06:18:56.338989",
  "task_download_url_internal": "http://service.local:5000/download/...",
  "metadata_url_internal": "http://service.local:5000/download/.../metadata.json",
  "client_meta": {"your":"meta"}
}
```

–û—à–∏–±–∫–∞:
```json
{
  "task_id": "...",
  "status": "error",
  "operation": "download_video_async",
  "error_type": "private_video|unavailable|deleted|...",
  "error_message": "...",
  "user_action": "...",
  "failed_at": "2025-11-15T06:20:00.000000",
  "client_meta": {"your":"meta"}
}
```

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- `webhook_url` –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http(s):// –∏ –±—ã—Ç—å –∫–æ—Ä–æ—á–µ 2048 —Å–∏–º–≤–æ–ª–æ–≤
- –¢–∞–π–º–∞—É—Ç –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8 —Å–µ–∫—É–Ω–¥ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è `WEBHOOK_TIMEOUT_SECONDS`)
- –ü–æ–≤—Ç–æ—Ä—ã –¥–æ—Å—Ç–∞–≤–∫–∏: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 5 —Å–µ–∫—É–Ω–¥
  - `WEBHOOK_RETRY_ATTEMPTS` ‚Äî —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ (default: 3)
  - `WEBHOOK_RETRY_INTERVAL_SECONDS` ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ (default: 5)
  - –û—à–∏–±–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å (best-effort)

### 8. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∏–¥–µ–æ

```bash
POST /get_video_info
Content-Type: application/json

{
  "url": "https://www.youtube.com/watch?v=VIDEO_ID"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "video_id": "VIDEO_ID",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ...",
  "duration": 180,
  "view_count": 1000000,
  "like_count": 50000,
  "uploader": "Channel Name",
  "upload_date": "20240115",
  "thumbnail": "https://...",
  "tags": ["tag1", "tag2"],
  "available_formats": 25,
  "processed_at": "2024-01-15T10:30:00.123456"
  "video_id": "VIDEO_ID",
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ...",
  "duration": 180,
  "view_count": 1000000,
  "like_count": 50000,
  "uploader": "Channel Name",
  "upload_date": "20240115",
  "thumbnail": "https://...",
  "tags": ["tag1", "tag2"],
  "available_formats": 25,
  "processed_at": "2024-01-15T10:30:00.123456"
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### cURL

```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É (–±–µ–∑ auth)
curl -X POST http://localhost:5000/get_direct_url \
  -H "Content-Type: application/json" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"}'

# –¢–æ –∂–µ —Å –≤–∫–ª—é—á–µ–Ω–Ω–æ–π auth (Bearer)
curl -X POST http://localhost:5000/get_direct_url \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $API_KEY" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"}'

# –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ
curl -X POST http://localhost:5000/download_video \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $API_KEY" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ", "quality": "best[height<=480]"}'

# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
curl -X POST http://localhost:5000/get_video_info \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $API_KEY" \
  -d '{"url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"}'
```

### Python

```python
import requests

# –ü–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É
response = requests.post('http://localhost:5000/get_direct_url', json={
    'url': 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
    'quality': 'best[height<=720]'
})

data = response.json()
print(f"Direct URL: {data['direct_url']}")

# –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ
response = requests.post('http://localhost:5000/download_video', json={
    'url': 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'
})

data = response.json()
download_url = f"http://localhost:5000{data['download_url']}"
print(f"Download URL: {download_url}")
```

### JavaScript (Node.js)

```javascript
const axios = require('axios');

// –ü–æ–ª—É—á–∏—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É
async function getDirectUrl(videoUrl) {
  const response = await axios.post('http://localhost:5000/get_direct_url', {
    url: videoUrl,
    quality: 'best[height<=720]'
  });

  return response.data.direct_url;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
getDirectUrl('https://www.youtube.com/watch?v=dQw4w9WgXcQ')
  .then(url => console.log('Direct URL:', url))
  .catch(err => console.error('Error:', err));
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞

```bash
git clone https://github.com/alexbic/youtube-downloader-api.git
cd youtube-downloader-api
docker build -t yt-dl-api:test .
docker run -p 5000:5000 yt-dl-api:test
```

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

```bash
pip install -r requirements.txt
python app.py
```

## CI/CD

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–æ–π –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ GitHub Actions.

–ü—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main` –≤–µ—Ç–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–æ–±–∏—Ä–∞–µ—Ç—Å—è Docker –æ–±—Ä–∞–∑ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º linux/amd64 –∏ linux/arm64
2. –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–∞ Docker Hub: `alexbic/youtube-downloader-api`
3. –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–∞ GitHub Container Registry: `ghcr.io/alexbic/youtube-downloader-api`
4. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ Docker Hub

–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–µ Actions](https://github.com/alexbic/youtube-downloader-api/actions)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11
- Flask 3.0.0
- yt-dlp (latest)
- FFmpeg
- Gunicorn
- Docker

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|---------|-------------|
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ URL** |||
| `API_KEY` | ‚Äî | –í–∫–ª—é—á–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–∂–∏–º (—Ç—Ä–µ–±—É–µ—Ç—Å—è Bearer). –ï—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–µ–∂–∏–º (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏). |
| `PUBLIC_BASE_URL` | ‚Äî | –í–Ω–µ—à–Ω–∏–π –±–∞–∑–æ–≤—ã–π URL –¥–ª—è –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (https://domain.com/api). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∑–∞–¥–∞–Ω `API_KEY`. |
| `INTERNAL_BASE_URL` | ‚Äî | –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–æ–Ω–æ–≤—ã—Ö URL (webhooks, Docker —Å–µ—Ç—å). |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤** |||
| ~~`WORKERS`~~ | `2` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ 2 –≤–æ—Ä–∫–µ—Ä–∞. |
| `GUNICORN_TIMEOUT` | `300` | –¢–∞–π–º–∞—É—Ç Gunicorn (—Å–µ–∫—É–Ω–¥—ã). |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis** |||
| ~~`REDIS_HOST`~~ | `localhost` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis. |
| ~~`REDIS_PORT`~~ | `6379` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis. |
| ~~`REDIS_DB`~~ | `0` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis. |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏** |||
| ~~`CLEANUP_TTL_SECONDS`~~ | `86400` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ 24 —á–∞—Å–∞. |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Webhook** |||
| `WEBHOOK_RETRY_ATTEMPTS` | `3` | –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ webhook (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–µ). |
| `WEBHOOK_RETRY_INTERVAL_SECONDS` | `5` | –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏ webhook (—Å–µ–∫—É–Ω–¥—ã). |
| `WEBHOOK_TIMEOUT_SECONDS` | `8` | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ webhook (—Å–µ–∫—É–Ω–¥—ã). |
| ~~`WEBHOOK_BACKGROUND_INTERVAL_SECONDS`~~ | `900` | ‚ùå **–ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –§–æ–Ω–æ–≤—ã–π resender —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ). |
| `DEFAULT_WEBHOOK_URL` | ‚Äî | –†–µ–∑–µ—Ä–≤–Ω—ã–π URL webhook (async). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `webhook_url`. –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http(s)://, < 2048 —Å–∏–º–≤–æ–ª–æ–≤. |
| `WEBHOOK_HEADERS` | ‚Äî | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è webhook POST. JSON –æ–±—ä–µ–∫—Ç –∏–ª–∏ —Å–ø–∏—Å–æ–∫: `{"Authorization":"Bearer XXX","X-Source":"ytdl"}` –ò–õ–ò `Authorization: Bearer XXX; X-Source: ytdl`. –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (Authorization, X-API-Key, X-Auth-Token) –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –∑–∞–ø—É—Å–∫–∞. |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** |||
| `LOG_LEVEL` | `INFO` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR, CRITICAL). |
| `PROGRESS_LOG` | `off` | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ yt-dlp (off, compact, full). |
| `PROGRESS_STEP` | `10` | –®–∞–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ % –¥–ª—è —Ä–µ–∂–∏–º–∞ compact. |
| **–õ–∏–º–∏—Ç—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞** |||
| `MAX_CLIENT_META_BYTES` | `16384` | –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä –¥–ª—è `client_meta` (–±–∞–π—Ç—ã). |
| `MAX_CLIENT_META_DEPTH` | `5` | –ú–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è `client_meta`. |
| `MAX_CLIENT_META_KEYS` | `200` | –ú–∞–∫—Å. –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π –≤ –æ–±—ä–µ–∫—Ç–µ `client_meta`. |

### –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤

```
/app/tasks/{task_id}/
  ‚îú‚îÄ‚îÄ video_*.mp4       # –°–∫–∞—á–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã (TTL: 24 —á–∞—Å–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
  ‚îî‚îÄ‚îÄ metadata.json     # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (TTL: 24 —á–∞—Å–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
```

**–û—á–∏—Å—Ç–∫–∞ (–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è):**
- ‚ö†Ô∏è **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ 24 —á–∞—Å–∞** - –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- –§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- –î–ª—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–≥–æ TTL –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [YouTube Downloader API Pro](https://github.com/alexbic/youtube-downloader-api-pro)

### Webhook Resender

–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤–∫–ª—é—á–∞–µ—Ç **—Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ webhook**, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –Ω–µ—É–¥–∞–≤—à–∏–µ—Å—è webhook:

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ –∫–∞–∂–¥—ã–µ **15 –º–∏–Ω—É—Ç** (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª, –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç webhook –¥–ª—è –∑–∞–¥–∞—á —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed` –∏–ª–∏ `error`, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ —É—Å–ø–µ—à–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É (HTTP 200-299)
- –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—ã –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ TTL (24 —á–∞—Å–∞)
- URL webhook —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∏ (–ø–æ–ª–µ `webhook_url` –≤ –æ—Ç–≤–µ—Ç–µ `/task/{task_id}`)

**–ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏:**
1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã**: 3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 5 —Å–µ–∫—É–Ω–¥ (–ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏)
2. **–§–æ–Ω–æ–≤—ã–µ –ø–æ–≤—Ç–æ—Ä—ã**: –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç –¥–æ —É—Å–ø–µ—à–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–ª–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è TTL

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `DEFAULT_WEBHOOK_URL` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ fallback webhook –¥–ª—è –≤—Å–µ—Ö async –∑–∞–¥–∞—á –±–µ–∑ —è–≤–Ω–æ–≥–æ `webhook_url`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `WEBHOOK_HEADERS` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: `{"Authorization": "Bearer XXX"}`
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É webhook –≤ –ª–æ–≥–∞—Ö (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `LOG_LEVEL=DEBUG` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ payload)

**–ü—Ä–∏–º–µ—Ä —Å default webhook:**
```yaml
environment:
  DEFAULT_WEBHOOK_URL: "https://your-server.com/webhooks/ytdl"
  WEBHOOK_HEADERS: '{"Authorization": "Bearer secret123"}'
```

### –ö–∞–∫ —Å—Ç—Ä–æ—è—Ç—Å—è —Å—Å—ã–ª–∫–∏
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞: `download_endpoint` (HTTP endpoint) –∏ `storage_rel_path` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –Ω–∞ –¥–∏—Å–∫–µ)
- –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –≤–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏: `task_download_url`, `metadata_url` (–∏—Å–ø–æ–ª—å–∑—É—é—Ç `PUBLIC_BASE_URL` –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π auth)
- –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏: `task_download_url_internal`, `metadata_url_internal` (–∏—Å–ø–æ–ª—å–∑—É—é—Ç `INTERNAL_BASE_URL`, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω; –∏–Ω–∞—á–µ `request.host_url`)

### –†–µ–∂–∏–º—ã
- Internal (auth=disabled): –±–µ–∑ `API_KEY` –∏ –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ `PUBLIC_BASE_URL`. –°—Å—ã–ª–∫–∏ –±—É–¥—É—Ç —Å—Ç—Ä–æ–∏—Ç—å—Å—è –æ—Ç `request.host_url`.
- Public (auth=enabled): `PUBLIC_BASE_URL` + `API_KEY` –∑–∞–¥–∞–Ω—ã. –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤–Ω–µ—à–Ω–∏–µ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ URL.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
- –ü–æ—Ä—è–¥–æ–∫ –∫–ª—é—á–µ–π JSON —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø–æ–ª–µ `client_meta` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è

## –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

### Production –∑–∞ reverse-proxy (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø)

**–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ 2 –≤–æ—Ä–∫–µ—Ä–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
- ‚úÖ TTL 24 —á–∞—Å–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)

**–ß—Ç–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**
- `PUBLIC_BASE_URL`: –ø—É–±–ª–∏—á–Ω—ã–π URL –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `https://yt.example.com`
- `API_KEY`: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (Bearer)
- `PROGRESS_LOG=off`: —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ª–æ–≥–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `LOG_LEVEL=INFO` (–∏–ª–∏ `ERROR` –¥–ª—è –µ—â—ë —Ç–∏—à–µ)

Docker run –ø—Ä–∏–º–µ—Ä:
```bash
docker run -d -p 5000:5000 \
  -e PUBLIC_BASE_URL=https://yt.example.com \
  -e API_KEY=${API_KEY} \
  -e PROGRESS_LOG=off \
  -e LOG_LEVEL=INFO \
  -v $(pwd)/tasks:/app/tasks \
  alexbic/youtube-downloader-api:latest
```

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ç—É—Ä (—Ç–æ–ª—å–∫–æ –∏–∑ –≤–∞—à–µ–π —Å–µ—Ç–∏)

–ë–µ–∑ `API_KEY` –∏ –±–µ–∑ `PUBLIC_BASE_URL` (auth=disabled):

```bash
docker run -d -p 5000:5000 \
  -e PROGRESS_LOG=off \
  -e LOG_LEVEL=INFO \
  -v $(pwd)/tasks:/app/tasks \
  alexbic/youtube-downloader-api:latest
```

### –û—Ç–ª–∞–¥–∫–∞
- –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å:
```bash
docker run -d -p 5000:5000 \
  -e PROGRESS_LOG=full -e LOG_LEVEL=DEBUG -e LOG_YTDLP_OPTS=true \
  alexbic/youtube-downloader-api:latest
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `LOG_LEVEL`: —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–Ω–∞—á–µ–Ω–∏—è: `DEBUG`, `INFO` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), `WARNING`, `ERROR`, `CRITICAL`.
- `PROGRESS_LOG`: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è yt-dlp.
  - `off` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-—Å–ø–∞–º (–≤–∫–ª—é—á–∞—é—Ç—Å—è quiet/noprogress —É yt-dlp).
  - `compact`: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ª–æ–≥–∏ —Ç–æ–ª—å–∫–æ –ø–æ —à–∞–≥–∞–º (–∫–∞–∂–¥—ã–µ `PROGRESS_STEP`%), –Ω–∞–ø—Ä–∏–º–µ—Ä: `[abcd1234] progress: 20%`.
  - `full`: –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ yt-dlp –∫–∞–∫ –µ—Å—Ç—å (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ).
- `PROGRESS_STEP`: —à–∞–≥ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –¥–ª—è `compact`-—Ä–µ–∂–∏–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10).
- `LOG_YTDLP_OPTS`: –µ—Å–ª–∏ `true`, –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏ yt-dlp (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏).
- `LOG_YTDLP_WARNINGS`: –µ—Å–ª–∏ `true`, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è yt-dlp –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞:

```bash
# –ü–æ–ª–Ω–æ–µ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)
docker run -d -p 5000:5000 \
  -e PROGRESS_LOG=off -e LOG_LEVEL=INFO \
  alexbic/youtube-downloader-api:latest

# –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 20%
docker run -d -p 5000:5000 \
  -e PROGRESS_LOG=compact -e PROGRESS_STEP=20 \
  alexbic/youtube-downloader-api:latest

# –ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
docker run -d -p 5000:5000 \
  -e PROGRESS_LOG=full -e LOG_LEVEL=DEBUG \
  alexbic/youtube-downloader-api:latest
```

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. YouTube –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É

**–ü—Ä–æ–±–ª–µ–º–∞:** `Sign in to confirm you're not a bot` –∏–ª–∏ `Private video`

**–†–µ—à–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ cookies –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ/–∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –æ–∫–Ω–∞ (—Å–º. —Å–µ–∫—Ü–∏—é "–ó–∞–ø—É—Å–∫ —Å cookies")
- –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É 5-10 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PO Token –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–∏–¥–µ–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º/—É–¥–∞–ª—ë–Ω–Ω—ã–º/—Å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º

#### 2. Redis –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** `Could not connect to Redis`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–º–µ–µ—Ç **–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis** - —ç—Ç–∞ –æ—à–∏–±–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞—Ç—å. –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç—É –æ—à–∏–±–∫—É:
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: `docker restart yt-downloader`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `docker logs yt-downloader`
- –î–ª—è –≤–Ω–µ—à–Ω–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Redis –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [YouTube Downloader API Pro](https://github.com/alexbic/youtube-downloader-api-pro)

#### 3. –§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** `404 File not found`

**–†–µ—à–µ–Ω–∏—è:**
- –§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –°–∫–∞—á–∏–≤–∞–π—Ç–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ `status: "completed"`
- –î–ª—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–≥–æ TTL –∏–ª–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [YouTube Downloader API Pro](https://github.com/alexbic/youtube-downloader-api-pro)

#### 4. Webhook –Ω–µ –ø–æ–ª—É—á–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** Webhook payload –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏—è:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook URL –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- API –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ 3 —Ä–∞–∑–∞ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 5 —Å–µ–∫—É–Ω–¥
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `docker logs youtube-downloader`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook endpoint –ø—Ä–∏–Ω–∏–º–∞–µ—Ç POST –∑–∞–ø—Ä–æ—Å—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ URL (http/https)

#### 5. –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 403 Forbidden

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –ø—Ä–æ—Ç—É—Ö–ª–∞ –∏–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

**–†–µ—à–µ–Ω–∏—è:**
- –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/download_video` –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- –°–∫–∞—á–∏–≤–∞–π—Ç–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–∏
- –î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ http_headers –∏–∑ –æ—Ç–≤–µ—Ç–∞

#### 6. –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** `401 Unauthorized` –∏–ª–∏ `Invalid API key`

**–†–µ—à–µ–Ω–∏—è:**
- –ï—Å–ª–∏ `API_KEY` –∑–∞–¥–∞–Ω, –≤—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç `Authorization: Bearer <key>`
- –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints: `/download_video`, `/get_direct_url`, `/get_video_info`
- –ü—É–±–ª–∏—á–Ω—ã–µ endpoints (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏): `/health`, `/task_status`, `/download`
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Docker —Ä–µ–∂–∏–º, –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–µ—Ä–∏—Ç–µ `API_KEY`

#### 7. –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ client_meta

**–ü—Ä–æ–±–ª–µ–º–∞:** `client_meta validation failed` –∏–ª–∏ `client_meta too large`

**–†–µ—à–µ–Ω–∏—è:**
- –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä: 16 –ö–ë (JSON UTF-8)
- –ú–∞–∫—Å. –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å: 5 —É—Ä–æ–≤–Ω–µ–π
- –ú–∞–∫—Å. –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π: 200 –≤—Å–µ–≥–æ
- –ú–∞–∫—Å. –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏: 1000 —Å–∏–º–≤–æ–ª–æ–≤
- –ú–∞–∫—Å. –¥–ª–∏–Ω–∞ —Å–ø–∏—Å–∫–∞: 200 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–æ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–æ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**
```bash
# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker logs -f youtube-downloader

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker logs --tail 100 youtube-downloader

# –õ–æ–≥–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
docker logs -t youtube-downloader
```

**–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- `DEBUG` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞—è –æ–ø—Ü–∏–∏ yt-dlp
- `INFO` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `WARNING` - —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR` - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
- `CRITICAL` - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**–†–µ–∂–∏–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:**
- `off` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –±–µ–∑ —Å–ø–∞–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- `compact` - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ N% (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `PROGRESS_STEP`)
- `full` - –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å yt-dlp (–æ—á–µ–Ω—å –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ)

---

## Troubleshooting –¥–ª—è n8n

### –û—à–∏–±–∫–∞: "Cannot create a string longer than 0x1fffffe8 characters"

**–ü—Ä–∏—á–∏–Ω–∞**: n8n —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ `binaryDataMode: "default"`, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏. –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>500MB) –ø–∞–º—è—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ 1: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å n8n –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)**

–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –≤–∞—à docker-compose.yml –∏–ª–∏ docker run:

```yaml
# docker-compose.yml
services:
  n8n:
    environment:
      - N8N_DEFAULT_BINARY_DATA_MODE=filesystem
      # ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

–ò–ª–∏ –¥–ª—è docker run:
```bash
docker run -e N8N_DEFAULT_BINARY_DATA_MODE=filesystem ...
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ n8n. –¢–µ–ø–µ—Ä—å –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –Ω–∞ –¥–∏—Å–∫ –≤–º–µ—Å—Ç–æ –ø–∞–º—è—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ HTTP Request node**

–í –Ω–æ–¥–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ (Node 2):
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTP Request node
2. –ù–∞–π–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä **"Response Format"**
3. –ò–∑–º–µ–Ω–∏—Ç–µ —Å "String" –Ω–∞ **"File"**
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ "Binary Property": **data**

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ queue mode –≤ n8n, —Ä–µ–∂–∏–º filesystem –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ S3 (`N8N_DEFAULT_BINARY_DATA_MODE=s3`).

### –û—à–∏–±–∫–∞: "Invalid URL: /download_file/..."

**–ü—Ä–∏—á–∏–Ω–∞**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ URL.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ `task_download_url` –∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞/—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
```
–ü—Ä–∞–≤–∏–ª—å–Ω–æ: {{ $json.task_download_url }}
–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: {{ $json.task_download_path }}
```

### –û—à–∏–±–∫–∞: "HTTP Error 403: Forbidden"

**–ü—Ä–∏—á–∏–Ω–∞**: YouTube –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ endpoint `/download_video` –≤–º–µ—Å—Ç–æ `/get_direct_url`. –ü–µ—Ä–≤—ã–π —Å–∫–∞—á–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ñ–∞–π–ª), –≤—Ç–æ—Ä–æ–π –¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –ø—Ä–æ—Ç—É—Ö–∞—Ç—å.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- API –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞–ø–∫–∞—Ö
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞ reverse proxy (nginx/traefik)
- –î–æ–±–∞–≤—å—Ç–µ rate limiting –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞

```bash
git clone https://github.com/alexbic/youtube-downloader-api.git
cd youtube-downloader-api
docker build -t youtube-downloader:local .
docker run -p 5000:5000 youtube-downloader:local
```

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
pip install -r requirements.txt
python app.py
```

---

## CI/CD

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –ø—É–±–ª–∏–∫—É–µ—Ç Docker –æ–±—Ä–∞–∑—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main`:

1. –°–æ–±–∏—Ä–∞–µ—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º: linux/amd64, linux/arm64
2. –ü—É–±–ª–∏–∫—É–µ—Ç –Ω–∞ Docker Hub: `alexbic/youtube-downloader-api`
3. –ü—É–±–ª–∏–∫—É–µ—Ç –Ω–∞ GitHub Container Registry: `ghcr.io/alexbic/youtube-downloader-api`
4. –û–±–Ω–æ–≤–ª—è–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ Docker Hub

–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏: [GitHub Actions](https://github.com/alexbic/youtube-downloader-api/actions)

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11
- Flask 3.0.0
- yt-dlp (latest)
- FFmpeg
- Gunicorn
- Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Docker

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE)

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- GitHub: [@alexbic](https://github.com/alexbic)
- Issues: [GitHub Issues](https://github.com/alexbic/youtube-downloader-api/issues)

## Disclaimer

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Å–æ–±–ª—é–¥–∞–µ—Ç–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è YouTube –∏ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
